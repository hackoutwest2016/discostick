<template name="game">
  {{#if hasBegun}}

    {{#if isHost}}

      {{#if havePicked}}

        <h1>All done!</h1>

        {{ > player }}

      {{else}}
        <h1>Pick a song for {{displayName getFocusedUser._id}}</h1>
      {{/if}}

    {{else}}
      {{#if havePicked }}
        Great! Now we wait.
      {{else}}
        {{ > songPickView round}}
      {{/if}}
    {{/if}}

  {{else}}
    <h1>Join the fun!</h1>

    <p>
      On <code><a href="{{url}}">{{url}}</a></code>
    </p>

    <ul class="user-list">
      {{#each players}}
      	<li>{{> avatar this}}</li>
      {{/each}}
    </ul>

    {{#if isHost}}
      <p>
        <button disabled="{{isDisabled}}" data-start-game>Everybody here? Start!</button>
      </p>
    {{/if}}
  {{/if}}

  <p>
    <a href="{{pathFor 'home'}}" data-leave>{{#if isHost}}Close game{{else}}Leave{{/if}}</a>
  </p>
</template>

<template name="songPickView">
  <div class="pick-song">
    <h1>Pick a song for {{displayName focusedUser}}</h1>

    <div class="search-form">
      <input type="search" placeholder="Track..." data-search>

      {{#if songs.count}}
        <ul class="song-list" data-songs>
          {{#each songs}}
          <li>
            {{#if cover}}<img src="{{cover}}" class="cover">{{/if}}

            <div class="song-meta">
              <strong class="song-name">{{name}}</strong><br>
              <span class="artist">{{artist}}</span>
            </div>
          </li>
          {{/each}}
        </ul>
      {{/if}}
    </div>
  </div>
</template>
