<template name="game">
  {{#if hasBegun}}

    {{#if isHost}}

      {{#if havePicked}}

        <div class="host-done">
          <h1>All done!</h1>

          {{ > player }}

          <p>
            <button data-start-game>New round</button>
          </p>
        </div>

      {{else}}
        <h1>Pick a song for {{displayName getFocusedUser._id}}</h1>
      {{/if}}

    {{else}}
      {{ #if havePicked }}
        <ul class="song-list" data-songs>
            {{#each chosenSongs}}
            <li>
              {{#if cover}}<img src="{{cover}}" class="cover">{{/if}}

              <div class="song-meta">
                <strong class="song-name">{{name}}</strong><br>
                <span class="artist">{{artist}}</span>
              </div>
            </li>
            {{/each}}
          </ul>

        <p class="have-picked">
          You picked <strong>{{pickedSong}}</strong>
        </p>
      {{else}}
        {{ > songPickView round}}
      {{/if}}
    {{/if}}

  {{else}}
    {{#if isHost}}
      <h1>Join the fun!</h1>
    {{else}}
      <h1>Waiting to startâ€¦</h1>
    {{/if}}

    <ul class="user-list">
      {{#each players}}
      	<li>{{> avatar this}}</li>
      {{/each}}
    </ul>

    {{#if isHost}}
      <p>
        <button disabled="{{isDisabled}}" data-start-game>{{#if isDisabled}}No players have joined{{else}}Everybody here? Start!{{/if}}</button>
      </p>
    {{/if}}
  {{/if}}
</template>

<template name="songPickView">
  <div class="pick-song">
    <h1>Pick a song for {{displayName focusedUser}}</h1>

    <div class="search-form">
      <input type="search" placeholder="Track..." data-search>

      {{#if songs.count}}
        <ul class="song-list" data-songs>
          {{#each songs}}
          <li>
            {{#if cover}}<img src="{{cover}}" class="cover">{{/if}}

            <div class="song-meta">
              <strong class="song-name">{{name}}</strong><br>
              <span class="artist">{{artist}}</span>
            </div>
          </li>
          {{/each}}
        </ul>
      {{/if}}
    </div>
  </div>
</template>
